<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Data Display</title>
</head>
<body>
    <h1>API Data Display</h1>
    <div style="padding: 10px; margin: 10px 0;">
        <strong>Note:</strong> CORS restrictions were addressed by using CORS proxy services (corsproxy.io and api.allorigins.win) to route API requests. <br> For best compatibility, serve this file via HTTP/HTTPS (not file://). 
        Use: <code>python3 -m http.server 8000</code> then visit <code>http://localhost:8000</code>
    </div>
    
    <div>
        <h2>Image Color Palette Generator</h2>
        <p>(For poster design)</p>
        <input type="file" id="image-input" accept="image/*">
        <div id="image-preview"></div>
        <div id="generated-palette"></div>
    </div>
    
    <div>
        <h2>LRCLIB API - Song Lyrics</h2>
        <p>(For lyric excerpt feature)</p>
        <div>
            <label>Artist: </label>
            <input type="text" id="lyrics-artist" value="Coldplay" style="margin: 5px;" onkeypress="if(event.key==='Enter') fetchLyrics()">
            <label>Title: </label>
            <input type="text" id="lyrics-title" value="Yellow" style="margin: 5px;" onkeypress="if(event.key==='Enter') fetchLyrics()">
            <button onclick="fetchLyrics()" style="margin: 5px; padding: 5px 10px;">Get Lyrics</button>
        </div>
        <div id="lrclib-content">Enter artist and title above, then click "Get Lyrics" or press Enter</div>
    </div>
    
    <div>
        <h2>Google Fonts API - Font Display</h2>
        <p>(For poster design)</p>
        <div id="google-fonts-content">Loading Google Fonts...</div>
    </div>
    
    <div>
        <h2>OpenAI GPT-5 Mini API</h2>
        <p>(For album info: release date, genre, record label, and album description feature)</p>
        <p>Waiting for approval before purchase.</p>
        <!-- <div id="openai-content">Loading GPT-5 Mini response...</div>
        <div>Note: Requires OpenAI API key. Update the code with your API key to use this feature.</div> -->
    </div>

    <script>
        // Image Color Palette Generator
        document.getElementById('image-input').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                const img = new Image();
                img.onload = function() {
                    const palette = extractColorPalette(img, 5);
                    displayPalette(palette, img);
                };
                img.src = event.target.result;
            };
            reader.readAsDataURL(file);
        });
        
        function extractColorPalette(img, numColors) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // Resize image for faster processing (max 200px on longest side)
            const maxSize = 200;
            let width = img.width;
            let height = img.height;
            
            if (width > height) {
                if (width > maxSize) {
                    height = (height / width) * maxSize;
                    width = maxSize;
                }
            } else {
                if (height > maxSize) {
                    width = (width / height) * maxSize;
                    height = maxSize;
                }
            }
            
            canvas.width = width;
            canvas.height = height;
            ctx.drawImage(img, 0, 0, width, height);
            
            const imageData = ctx.getImageData(0, 0, width, height);
            const pixels = imageData.data;
            
            // Sample pixels (every nth pixel for performance)
            const sampleRate = 10;
            const colorSamples = [];
            
            for (let i = 0; i < pixels.length; i += 4 * sampleRate) {
                const r = pixels[i];
                const g = pixels[i + 1];
                const b = pixels[i + 2];
                const a = pixels[i + 3];
                
                // Skip transparent pixels
                if (a < 128) continue;
                
                colorSamples.push({ r, g, b });
            }
            
            // Use k-means clustering to find dominant colors
            return kMeansClustering(colorSamples, numColors);
        }
        
        function kMeansClustering(colors, k) {
            if (colors.length === 0) return [];
            
            // Initialize centroids randomly
            const centroids = [];
            for (let i = 0; i < k; i++) {
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                centroids.push({ r: randomColor.r, g: randomColor.g, b: randomColor.b });
            }
            
            // Iterate to find clusters
            for (let iteration = 0; iteration < 10; iteration++) {
                const clusters = Array(k).fill().map(() => []);
                
                // Assign each color to nearest centroid
                colors.forEach(color => {
                    let minDist = Infinity;
                    let nearestCluster = 0;
                    
                    centroids.forEach((centroid, idx) => {
                        const dist = colorDistance(color, centroid);
                        if (dist < minDist) {
                            minDist = dist;
                            nearestCluster = idx;
                        }
                    });
                    
                    clusters[nearestCluster].push(color);
                });
                
                // Update centroids
                centroids.forEach((centroid, idx) => {
                    if (clusters[idx].length > 0) {
                        const sum = clusters[idx].reduce((acc, color) => {
                            acc.r += color.r;
                            acc.g += color.g;
                            acc.b += color.b;
                            return acc;
                        }, { r: 0, g: 0, b: 0 });
                        
                        centroid.r = Math.round(sum.r / clusters[idx].length);
                        centroid.g = Math.round(sum.g / clusters[idx].length);
                        centroid.b = Math.round(sum.b / clusters[idx].length);
                    }
                });
            }
            
            // Convert RGB to hex
            return centroids.map(centroid => {
                return rgbToHex(centroid.r, centroid.g, centroid.b);
            });
        }
        
        function colorDistance(c1, c2) {
            const dr = c1.r - c2.r;
            const dg = c1.g - c2.g;
            const db = c1.b - c2.b;
            return Math.sqrt(dr * dr + dg * dg + db * db);
        }
        
        function rgbToHex(r, g, b) {
            return '#' + [r, g, b].map(x => {
                const hex = x.toString(16);
                return hex.length === 1 ? '0' + hex : hex;
            }).join('');
        }
        
        function displayPalette(palette, img) {
            const previewDiv = document.getElementById('image-preview');
            const paletteDiv = document.getElementById('generated-palette');
            
            // Display image preview
            previewDiv.innerHTML = `<img src="${img.src}" style="max-width: 400px; max-height: 300px; margin: 10px 0;">`;
            
            // Display palette
            let html = '<div><strong>Generated 5-Color Palette:</strong><div>';
            palette.forEach(color => {
                html += `<div style="background-color: ${color}; width: 100px; height: 100px; display: inline-block; margin: 5px; border: 1px solid #ccc;" title="${color}">
                    <div style="padding: 5px; color: ${getContrastColor(color)}; font-size: 12px;">${color}</div>
                </div>`;
            });
            html += '</div></div>';
            paletteDiv.innerHTML = html;
        }
        
        function getContrastColor(hex) {
            // Convert hex to RGB
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            
            // Calculate luminance
            const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;
            
            // Return black or white based on luminance
            return luminance > 0.5 ? '#000000' : '#ffffff';
        }

        // LRCLIB API - Fetch lyrics
        async function fetchLyrics() {
            const container = document.getElementById('lrclib-content');
            
            // Get values from input fields
            const artistInput = document.getElementById('lyrics-artist');
            const titleInput = document.getElementById('lyrics-title');
            const artist = artistInput.value.trim();
            const track = titleInput.value.trim();
            
            // Validate inputs
            if (!artist || !track) {
                container.innerHTML = 'Please enter both artist and title.';
                return;
            }
            
            container.innerHTML = 'Loading lyrics...';
            
            // Use CORS proxy since LRCLIB has CORS restrictions
            const proxy = 'https://corsproxy.io/?';
            
            try {
                // Go directly to /api/get endpoint (much faster - one request instead of two)
                const getUrl = proxy + encodeURIComponent(`https://lrclib.net/api/get?track_name=${encodeURIComponent(track)}&artist_name=${encodeURIComponent(artist)}`);
                console.log('Fetching lyrics directly:', getUrl);
                
                const getResponse = await fetch(getUrl);
                
                // If direct get fails, try searching with better matching
                if (!getResponse.ok) {
                    console.log('Direct get failed, trying search with better matching...');
                    
                    // Search and find the best match
                    const searchUrl = proxy + encodeURIComponent(`https://lrclib.net/api/search?q=${encodeURIComponent(artist + ' ' + track)}`);
                    const searchResponse = await fetch(searchUrl);
                    
                    if (!searchResponse.ok) {
                        throw new Error(`Search failed: ${searchResponse.status}`);
                    }
                    
                    const searchData = await searchResponse.json();
                    
                    if (!Array.isArray(searchData) || searchData.length === 0) {
                        throw new Error('No search results found');
                    }
                    
                    // Find the best match - prioritize exact track name match
                    const trackLower = track.toLowerCase();
                    let bestMatch = searchData[0];
                    let bestScore = 0;
                    
                    for (const result of searchData) {
                        const resultTrack = (result.trackName || result.name || '').toLowerCase();
                        const resultArtist = (result.artistName || result.artist || '').toLowerCase();
                        const artistLower = artist.toLowerCase();
                        
                        // Score based on exact matches
                        let score = 0;
                        if (resultTrack === trackLower && resultArtist === artistLower) {
                            score = 100; // Perfect match
                        } else if (resultTrack === trackLower) {
                            score = 50; // Track matches, artist might be different
                        } else if (resultTrack.includes(trackLower) && resultArtist === artistLower) {
                            score = 30; // Track contains search term
                        } else if (resultArtist === artistLower) {
                            score = 10; // Only artist matches
                        }
                        
                        if (score > bestScore) {
                            bestScore = score;
                            bestMatch = result;
                        }
                    }
                    
                    console.log('Best match found:', bestMatch);
                    
                    // Fetch full lyrics for the best match
                    const matchGetUrl = proxy + encodeURIComponent(`https://lrclib.net/api/get?track_name=${encodeURIComponent(bestMatch.trackName || bestMatch.name)}&artist_name=${encodeURIComponent(bestMatch.artistName || bestMatch.artist)}`);
                    const matchGetResponse = await fetch(matchGetUrl);
                    
                    if (!matchGetResponse.ok) {
                        throw new Error(`Get failed: ${matchGetResponse.status}`);
                    }
                    
                    const lyricsData = await matchGetResponse.json();
                    displayLyrics(lyricsData, container);
                    return;
                }
                
                // Direct get succeeded
                const lyricsData = await getResponse.json();
                displayLyrics(lyricsData, container);
                
            } catch (error) {
                container.innerHTML = 
                    `Error loading LRCLIB API: ${error.message}<br>
                    <small>Check the browser console for more details.</small>`;
                console.error('LRCLIB API error:', error);
            }
        }
        
        function displayLyrics(lyricsData, container) {
            // Use plainLyrics (simpler) or syncedLyrics (time-synced)
            const lyrics = lyricsData.plainLyrics || 
                          (lyricsData.syncedLyrics && Array.isArray(lyricsData.syncedLyrics) ? 
                            lyricsData.syncedLyrics.map(line => line.text || line).join('\n') : 
                            lyricsData.syncedLyrics) ||
                          lyricsData.lyrics;
            
            const artistName = lyricsData.artistName || 'Unknown';
            const trackName = lyricsData.trackName || lyricsData.name || 'Unknown';
            
            if (lyrics) {
                container.innerHTML = `<pre>${lyrics}</pre>
                    <div>Artist: ${artistName} | Title: ${trackName}</div>`;
            } else {
                container.innerHTML = 
                    `Lyrics data received but no lyrics field found.<br>
                    <small>Available fields: ${Object.keys(lyricsData).join(', ')}</small>`;
            }
        }

        // Google Fonts API - Load and display fonts
        async function fetchGoogleFonts() {
            try {
                const fontLink = document.createElement('link');
                fontLink.rel = 'stylesheet';
                fontLink.href = 'https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Playfair+Display:wght@400;700&display=swap';
                document.head.appendChild(fontLink);
                
                const container = document.getElementById('google-fonts-content');
                
                fontLink.onload = () => {
                    container.innerHTML = `
                        <div style="font-family: 'Roboto', sans-serif; font-weight: 300;">
                            Roboto Light: The quick brown fox jumps over the lazy dog
                        </div>
                        <div style="font-family: 'Roboto', sans-serif; font-weight: 400;">
                            Roboto Regular: The quick brown fox jumps over the lazy dog
                        </div>
                        <div style="font-family: 'Roboto', sans-serif; font-weight: 700;">
                            Roboto Bold: The quick brown fox jumps over the lazy dog
                        </div>
                        <div style="font-family: 'Playfair Display', serif; font-weight: 400;">
                            Playfair Display Regular: The quick brown fox jumps over the lazy dog
                        </div>
                        <div style="font-family: 'Playfair Display', serif; font-weight: 700;">
                            Playfair Display Bold: The quick brown fox jumps over the lazy dog
                        </div>
                        <div>Fonts loaded from Google Fonts CSS2 API</div>
                    `;
                };
                
                setTimeout(() => {
                    if (container.innerHTML.includes('Loading')) {
                        container.innerHTML = 'Font loading timeout. Check your internet connection.';
                    }
                }, 5000);
                
            } catch (error) {
                document.getElementById('google-fonts-content').innerHTML = 
                    `Error loading Google Fonts: ${error.message}`;
                console.error('Google Fonts error:', error);
            }
        }

        // OpenAI GPT-5 Mini API - Fetch response
        // Currently disabled - waiting for API key purchase
        async function fetchOpenAI() {
            // Check if the OpenAI content element exists (it's commented out in HTML)
            const container = document.getElementById('openai-content');
            if (!container) {
                // Element doesn't exist, function is disabled
                return;
            }
            
            try {
                const apiKey = 'YOUR_API_KEY';
                
                if (apiKey === 'YOUR_API_KEY') {
                    container.innerHTML = 
                        `OpenAI API key not configured. Please add your API key to the code.
                        <pre>To use this API:
1. Get an API key from https://platform.openai.com/
2. Replace 'YOUR_API_KEY' in the code with your actual key
3. Note: GPT-5-mini may not be available yet. Try 'gpt-4o-mini' or 'gpt-3.5-turbo' instead.</pre>`;
                    return;
                }
                
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${apiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [
                            { role: 'user', content: 'Tell me a fun fact about technology in one sentence.' }
                        ],
                        max_tokens: 100
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(errorData.error?.message || `HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (data.choices && data.choices.length > 0) {
                    container.innerHTML = `
                        <div>${data.choices[0].message.content}</div>
                        <div>Model: ${data.model} | Tokens used: ${data.usage?.total_tokens || 'N/A'}</div>
                    `;
                } else {
                    container.innerHTML = 'No response received from OpenAI API.';
                }
            } catch (error) {
                if (container) {
                    container.innerHTML = 
                        `Error loading OpenAI API: ${error.message}`;
                }
                console.error('OpenAI API error:', error);
            }
        }

        // Initialize all API calls
        fetchGoogleFonts();
        // fetchOpenAI(); // Disabled - waiting for API key purchase
    </script>
    
    <hr style="margin: 40px 0;">
    <h1 style="text-align: center; margin-top: 40px;">API Data Examples (For Screenshot)</h1>
    
    <div style="margin: 30px 0;">
        <h2>ColorMagic API - Sample Color Palette Data</h2>
        <div>
            <strong>Palette 1: Nature Theme</strong>
            <div style="margin-top: 10px;">
                <div style="background-color: #2d5016; width: 100px; height: 100px; display: inline-block; margin: 5px; border: 1px solid #ccc; color: white; text-align: center; line-height: 100px;">#2d5016</div>
                <div style="background-color: #5a8a3a; width: 100px; height: 100px; display: inline-block; margin: 5px; border: 1px solid #ccc; color: white; text-align: center; line-height: 100px;">#5a8a3a</div>
                <div style="background-color: #8fb86f; width: 100px; height: 100px; display: inline-block; margin: 5px; border: 1px solid #ccc; color: black; text-align: center; line-height: 100px;">#8fb86f</div>
                <div style="background-color: #c4d9a8; width: 100px; height: 100px; display: inline-block; margin: 5px; border: 1px solid #ccc; color: black; text-align: center; line-height: 100px;">#c4d9a8</div>
                <div style="background-color: #e8f0d8; width: 100px; height: 100px; display: inline-block; margin: 5px; border: 1px solid #ccc; color: black; text-align: center; line-height: 100px;">#e8f0d8</div>
            </div>
        </div>
    </div>
    
    <div style="margin: 30px 0;">
        <h2>LRCLIB API - Sample Lyrics Data</h2>
        <div>
            <strong>Artist: Coldplay | Title: Yellow</strong>
            <pre style="background: #f8f9fa; padding: 15px; border-radius: 8px; white-space: pre-wrap; max-height: 300px; overflow-y: auto;">
Look at the stars
Look how they shine for you
And everything you do
Yeah, they were all yellow

I came along
I wrote a song for you
And all the things you do
And it was called "Yellow"

So then I took my turn
Oh, what a thing to have done
And it was all yellow

Your skin, oh yeah, your skin and bones
Turn into something beautiful
You know, you know I love you so
You know I love you so

I swam across
I jumped across for you
Oh, what a thing to do
'Cause you were all yellow

I drew a line
I drew a line for you
Oh, what a thing to do
And it was all yellow

Your skin, oh yeah, your skin and bones
Turn into something beautiful
You know, for you I'd bleed myself dry
For you I'd bleed myself dry

It's true, look how they shine for you
Look how they shine for you
Look how they shine for
Look how they shine for you
Look how they shine for you
Look how they shine
            </pre>
        </div>
    </div>
    
    <div style="margin: 30px 0;">
        <h2>Google Fonts API - Sample Font Display</h2>
        <div style="font-family: 'Roboto', sans-serif; font-weight: 300; margin: 10px 0;">
            Roboto Light: The quick brown fox jumps over the lazy dog
        </div>
        <div style="font-family: 'Roboto', sans-serif; font-weight: 400; margin: 10px 0;">
            Roboto Regular: The quick brown fox jumps over the lazy dog
        </div>
        <div style="font-family: 'Roboto', sans-serif; font-weight: 700; margin: 10px 0;">
            Roboto Bold: The quick brown fox jumps over the lazy dog
        </div>
        <div style="font-family: 'Playfair Display', serif; font-weight: 400; margin: 10px 0;">
            Playfair Display Regular: The quick brown fox jumps over the lazy dog
        </div>
        <div style="font-family: 'Playfair Display', serif; font-weight: 700; margin: 10px 0;">
            Playfair Display Bold: The quick brown fox jumps over the lazy dog
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Fonts loaded from Google Fonts CSS2 API
        </div>
    </div>
    
    <div style="margin: 30px 0;">
        <h2>OpenAI GPT-5 Mini API - Sample Album Information</h2>
        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
            <div style="margin-bottom: 10px;">
                <strong>Album:</strong> Parachutes<br>
                <strong>Release Date:</strong> July 10, 2000<br>
                <strong>Genre:</strong> Alternative Rock, Britpop<br>
                <strong>Record Label:</strong> Parlophone, Capitol Records<br>
                <strong>Description:</strong> Parachutes is the debut studio album by British rock band Coldplay. Released in 2000, it features the hit single "Yellow" and established the band's signature atmospheric sound blending alternative rock with emotional, introspective lyrics. The album received critical acclaim and won the Grammy Award for Best Alternative Music Album in 2002.
            </div>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Sample data format - Actual API integration pending approval
        </div>
    </div>
</body>
</html>